<ng-container>
  <c-container [fluid]="true" class="border-bottom px-4">
    <button
      [cSidebarToggle]="sidebarId"
      cHeaderToggler
      class="btn"
      toggle="visible"
      style="margin-inline-start: -14px;"
      aria-label="Toggle sidebar navigation"
    >
      <svg cIcon name="cilMenu" size="lg"></svg>
    </button>
    <c-header-nav class="d-none d-md-flex">
<!--      <c-nav-item>-->
<!--        <a cNavLink routerLink="/dashboard" routerLinkActive="active">Dashboard</a>-->
<!--      </c-nav-item>-->
<!--      <c-nav-item>-->
<!--        <a cNavLink routerLink="/users" routerLinkActive="active">Users</a>-->
<!--      </c-nav-item>-->
<!--      <c-nav-item>-->
<!--        <a cNavLink routerLink="/settings" routerLinkActive="active">Settings</a>-->
<!--      </c-nav-item>-->
    </c-header-nav>

    <c-header-nav class="d-none d-md-flex ms-auto ">
<!--      <a cNavLink>-->
<!--        <svg cIcon class="my-1" name="cilBell" size="lg"></svg>-->
<!--      </a>-->
      <ng-container *ngTemplateOutlet="AlertDropdown" />

      <!--      <a cNavLink>-->
<!--        <svg cIcon class="my-1" name="cilList" size="lg"></svg>-->
<!--      </a>-->
<!--      <a cNavLink>-->
<!--        <svg cIcon class="my-1" name="cilEnvelopeOpen" size="lg"></svg>-->
<!--      </a>-->
    </c-header-nav>

    <c-header-nav class="ms-auto ms-md-0">
      <ng-container *ngTemplateOutlet="ConfigDropdown" />
    </c-header-nav>

    <c-header-nav class="ms-auto ms-md-0">
      <div class="nav-item py-1">
        <div class="vr h-100 mx-2 text-body text-opacity-75"></div>
      </div>
      <ng-container *ngTemplateOutlet="themeDropdown" />
      <div class="nav-item py-1">
        <div class="vr h-100 mx-2 text-body text-opacity-75"></div>
      </div>
    </c-header-nav>

    <c-header-nav class="mx-0">
      <ng-container *ngTemplateOutlet="userDropdown" />
    </c-header-nav>

  </c-container>
<!--  <c-container [fluid]="true" class="px-4">-->
<!--    <c-breadcrumb-router />-->
<!--  </c-container>-->
</ng-container>
<!--</c-header>-->

<ng-template #userDropdown>
  <c-dropdown [popperOptions]="{ placement: 'bottom-start' }" variant="nav-item">
    <button [caret]="false" cDropdownToggle class="py-0 pe-0" aria-label="Open user menu">
      <c-avatar
        shape="rounded-1"
        [size]="'md'"
        src="./assets/images/avatars/8.jpg"
        status="success"
        textColor="primary"
        alt="User avatar"
      />
    </button>
    <ul cDropdownMenu class="pt-0 w-auto">
      <li>
        <h6 cDropdownHeader class="bg-body-secondary text-body-secondary fw-semibold py-2 rounded-top">
          Notificaciones
        </h6>
      </li>
      <li>
        <a cDropdownItem routerLink="/alerta">
          <svg cIcon class="me-2" name="cilBell"></svg>
          Alertas
          <c-badge class="ms-2 float-end" color="info"> !!</c-badge>
        </a>
      </li>
      <li>
      <li >
        <a cDropdownItem class="pointer-cursor" routerLink="/perfil">
          <svg cIcon class="me-2" name="cilUser"></svg>
          Perfil
        </a>
      </li>
<!--        <a cDropdownItem routerLink="/apps/email/inbox">-->
<!--          <svg cIcon class="me-2" name="cilEnvelopeOpen"></svg>-->
<!--          Messages-->
<!--          <c-badge class="ms-2 float-end" color="success">-->
<!--            42-->
<!--          </c-badge>-->
<!--        </a>-->
<!--      </li>-->
<!--      <li>-->
<!--        <a cDropdownItem routerLink="">-->
<!--          <svg cIcon class="me-2" name="cilTask"></svg>-->
<!--          Tasks-->
<!--          <c-badge class="ms-2 float-end" color="danger"> 42</c-badge>-->
<!--        </a>-->
<!--      </li>-->
<!--      <li>-->
<!--        <a cDropdownItem routerLink="">-->
<!--          <svg cIcon class="me-2" name="cilCommentSquare"></svg>-->
<!--          Comments-->
<!--          <c-badge class="ms-auto" color="warning"> 42</c-badge>-->
<!--        </a>-->
<!--      </li>-->
      <li>
        <h6 cDropdownHeader class="bg-body-secondary text-body-secondary fw-semibold py-2">
          Salir
        </h6>
      </li>
      <li></li>

<!--      <li>-->
<!--        <a cDropdownItem routerLink="">-->
<!--          <svg cIcon class="me-2" name="cilSettings"></svg>-->
<!--          Settings-->
<!--        </a>-->
<!--      </li>-->
<!--      <li>-->
<!--        <a cDropdownItem routerLink="">-->
<!--          <svg cIcon class="me-2" name="cilCreditCard"></svg>-->
<!--          Payments-->
<!--          <c-badge class="ms-2 float-end" color="secondary">-->
<!--            42-->
<!--          </c-badge>-->
<!--        </a>-->
<!--      </li>-->
<!--      <li>-->
<!--        <a cDropdownItem routerLink="">-->
<!--          <svg cIcon class="me-2" name="cilFile"></svg>-->
<!--          Projects-->
<!--          <c-badge class="ms-2 float-end" color="primary">-->
<!--            42-->
<!--          </c-badge>-->
<!--        </a>-->
<!--      </li>-->
      <li>
        <hr cDropdownDivider />
      </li>
<!--      <li>-->
<!--        <a cDropdownItem routerLink="" (click)="logout()">-->
<!--          <svg cIcon class="me-2" name="cilLockLocked"></svg>-->
<!--          Lock Account-->
<!--        </a>-->
<!--      </li>-->
      <li>
        <a cDropdownItem routerLink="" (click)="logout()">
          <svg cIcon class="me-2" name="cilAccountLogout"></svg>
          Logout
        </a>
      </li>
    </ul>
  </c-dropdown>
</ng-template>

<ng-template #themeDropdown>
  <c-dropdown alignment="end" variant="nav-item">
    <button [caret]="false" cDropdownToggle aria-label="Open theme picker">
      <svg cIcon [name]="icons()" size="lg"></svg>
    </button>
    <div cDropdownMenu>
      @for (mode of colorModes; track mode.name) {
        <button
          (click)="colorMode.set(mode.name)"
          [active]="colorMode()===mode.name"
          [routerLink]="[]"
          cDropdownItem
          class="d-flex align-items-center"
        >
          <svg cIcon class="me-2" [name]="mode.icon" size="lg"></svg>
          {{ mode.text }}
        </button>
      }
    </div>
  </c-dropdown>
</ng-template>

<ng-template #ConfigDropdown>
  <c-dropdown alignment="end" variant="nav-item" [autoClose]="false">
    <button [caret]="false" cDropdownToggle aria-label="Open configuration picker" (click)="crud_close()">
      <svg cIcon name="cilSettings" size="lg"></svg>
    </button>
    <div cDropdownMenu style="width: 260px; padding: 10px;"> <!-- Ajuste de anchura y padding -->
      <div>
        <h5 class="card-title d-flex align-items-center mb-3">Tiempo de reporte</h5>
        <h5 class="card-title d-flex align-items-center mb-3">
          Configuración Actual
          <span class="ms-2">
            <span class="d-inline-block">
              <button class="btn p-0 ml-2" (click)="desplegarcrud()"> <svg cIcon name="cilPencil" size="lg"></svg></button>

            </span>
          </span>
        </h5>

        <div style="margin-left: 10px;"> <!-- Ajuste de margen izquierdo -->
          <span>Tiempo de Respuesta</span>
          <label class="d-block mt-2">
            <div class="morado">{{configuracion.tiempoRespuesta}} Segundos</div>
          </label>
          <!-- Aquí van los campos para editar la configuración -->

          <div *ngIf="showTable">


            <label cLabel for="customRange1">Segundos: <strong>{{value}}</strong></label>
            <br>
            <input [(ngModel)]="value" cFormControl id="customRange1" [max]="480" [min]="1" type="range" class="full-width-range" />
            <br>
            <button type="submit" class="btn btn-primary" (click)="actualizartiempo()">Guardar</button>



          </div>
        </div>
      </div>
    </div>
  </c-dropdown>
</ng-template>
<!--<ng-template #AlertDropdown>-->
<!--  <c-dropdown alignment="end" variant="nav-item" [autoClose]="false">-->
<!--    <button [caret]="false" cDropdownToggle aria-label="Open configuration picker" (click)="crud_close()">-->
<!--      <svg cIcon name="cilBell" size="lg"></svg>-->
<!--    </button>-->
<!--    <div cDropdownMenu style="width: 260px; padding: 10px;"> &lt;!&ndash; Ajuste de anchura y padding &ndash;&gt;-->
<!--      <div>-->
<!--        <h5 class="card-title d-flex align-items-center mb-3">Alertas Recientes</h5>-->
<!--        <div *ngFor="let alerta of alertas" class="alerta-item">-->
<!--          <p><strong>Fecha:</strong> {{ alerta.fecha }}</p>-->
<!--          <p><strong>Descripción:</strong> {{ alerta.descripcion }}</p>-->
<!--          <p><strong>Dispositivo:</strong> {{ alerta.dispositivo?.nombre }}</p>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </c-dropdown>-->
<!--</ng-template>-->
<ng-template #AlertDropdown>
  <c-dropdown alignment="end" variant="nav-item" [autoClose]="false">
    <button [caret]="false" cDropdownToggle aria-label="Open configuration picker" (click)="crud_close()">
      <svg cIcon name="cilBell" size="lg"></svg>
    </button>
    <div cDropdownMenu style="width: 260px; padding: 10px; max-height: 300px; overflow-y: auto;">
      <div>
        <h5 class="card-title d-flex align-items-center mb-3">Alertas Recientes</h5>
        <div *ngFor="let alerta of alertas.slice(-5)" class="alerta-item">
          <div class="alerta-header">
            <span class="alerta-dispositivo">{{ alerta.dispositivo?.nombre }}</span>
            <span class="alerta-fecha">{{ alerta.fecha ? alerta.fecha.toString().split("T")[0]  : 'NA' }}
              <div class="small text-body-secondary text-nowrap"><span>{{ alerta.fecha ? formatDate2(alerta.fecha, 'HH:mm') : 'NA' }}</span></div>
            </span>
          </div>
          <p class="alerta-descripcion">{{ alerta.descripcion }}</p>
        </div>
      </div>
    </div>
  </c-dropdown>
</ng-template>


<!--&lt;!&ndash; custom-modal.component.html &ndash;&gt;-->
<!--<div class="modal" *ngIf="isVisible">-->
<!--  <div class="modal-content">-->
<!--    <div class="modal-header">-->
<!--      <span class="close" (click)="closeModal()">&times;</span>-->
<!--      <h2>Nueva Alerta</h2>-->
<!--    </div>-->
<!--    <div class="modal-body">-->
<!--      <p><strong>Fecha:</strong> {{ alerta?.fecha }}</p>-->
<!--      <p><strong>Descripción:</strong> {{ alerta?.descripcion }}</p>-->
<!--      <p><strong>Dispositivo:</strong> {{ alerta?.dispositivo?.nombre }}</p>-->
<!--    </div>-->
<!--    <div class="modal-footer">-->
<!--      <button (click)="closeModal()">Cerrar</button>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->

<div class="modal" *ngIf="isVisible">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Nueva Alerta</h2>
      <button class="close" (click)="closeModal()">&times;</button>
    </div>
    <div class="modal-body">
      <p><strong>Fecha:</strong> {{ alerta?.fecha }}</p>
      <p><strong>Descripción:</strong> {{ alerta?.descripcion }}</p>
      <p><strong>Dispositivo:</strong> {{ alerta?.dispositivo?.nombre }}</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeModal()">Cerrar</button>
    </div>
  </div>
</div>


